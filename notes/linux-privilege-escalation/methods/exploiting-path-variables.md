# Exploiting Path Variables

**What is PATH?**

PATH is an environmental variable in Linux and Unix-like operating systems which specifies directories that hold executable programs. When the user runs any command in the terminal, it searches for executable files with the help of the PATH Variable in response to commands executed by a user.  


It is very simple to view the Path of the relevant user with help of the command **"echo $PATH"**.

**How does this let us escalate privileges?**

Let's say we have an SUID binary. Running it, we can see that itâ€™s calling the system shell to do a basic process like list processes with "ps". Unlike in our previous SUID example, in this situation we can't exploit it by supplying an argument for command injection, so what can we do to try and exploit this?

We can re-write the PATH variable to a location of our choosing! So when the SUID binary calls the system shell to run an executable, it runs one that we've written instead!

As with any SUID file, it will run this command with the same privileges as the owner of the SUID file! If this is root, using this method we can run whatever commands we like as root!



we need to change the PATH variable, so that it points to the directory where we have our imitation **"ls"** stored! We do this using the command **"export PATH=/tmp:$PATH"**

\*\*\*\*

Once you've finished the exploit, you can exit out of root and use **"export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:$PATH"** to reset the PATH variable back to default

